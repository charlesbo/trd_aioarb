<?xml version="1.0" encoding="UTF-8"?>
<!--
    EZDG Dynamic Grid Strategy Configuration Example
    
    This is a sample XML configuration for the EZDG (EZ Dynamic Grid) strategy
    with the new dynamic grid parameters.
-->

<Strategy name="EZDG" type="EZDG">
    
    <!-- ========================================
         ACCOUNT AND BASIC SETTINGS
         ======================================== -->
    <Property name="accountID" value="your_account_id"/>
    <Property name="Prod" value="cu"/>
    <Property name="ShmNmPrefix" value=""/>
    <Property name="MdqpFolder" value="../config/"/>
    <Property name="SprdConn" value="-"/>
    
    <!-- ========================================
         TRADE CONTROL SETTINGS
         ======================================== -->
    <!-- 1=enabled, 0=disabled, -1=only close, -2=force close -->
    <Property name="EnableTrade" value="1"/>
    
    <!-- ========================================
         DYNAMIC GRID PARAMETERS (NEW)
         ======================================== -->
    <!-- Grid spacing in ticks (default: 1.0)
         - Smaller values (0.5-1.0): Tighter grid, more frequent trades
         - Larger values (2.0-5.0): Wider grid, less frequent trades -->
    <Property name="GridSpacing" value="1.0"/>
    
    <!-- Number of grid levels on each side (default: 5)
         - Currently not fully utilized, reserved for future multi-level grid
         - Recommended: Keep at 5 -->
    <Property name="GridWidth" value="5"/>
    
    <!-- Position-dependent asymmetry factor (default: 0.5)
         - 0.0: No asymmetry (symmetric grid regardless of position)
         - 0.5: Moderate asymmetry (recommended for risk management)
         - 1.0: Strong asymmetry (aggressive position closing)
         - Higher values encourage faster position closes -->
    <Property name="GridAsymmetry" value="0.5"/>
    
    <!-- Enable position-dependent grids (default: 1)
         - 1: Enable position-dependent grid adjustment (recommended)
         - 0: Use simple symmetric grid without position adjustment -->
    <Property name="UsePositionGrid" value="1"/>
    
    <!-- ========================================
         ORDER TIMING PARAMETERS
         ======================================== -->
    <!-- Wait time for try orders in milliseconds (default: 100) -->
    <Property name="TryOrderWaitTime" value="100"/>
    
    <!-- Price adjustment for try orders in ticks (default: 0) -->
    <Property name="TryOrderPriceAdj" value="0"/>
    
    <!-- Which leg to try first (-1=auto select, 0,1,2...=specific leg) -->
    <Property name="TryLegID" value="-1"/>
    
    <!-- Wait time for force orders in milliseconds (default: 100) -->
    <Property name="ForceOrderWaitTime" value="100"/>
    
    <!-- Maximum time for force task in milliseconds (default: 10000) -->
    <Property name="ForceTaskWaitTime" value="10000"/>
    
    <!-- Starting price adjustment for force orders (default: 0) -->
    <Property name="StartPriceAdj" value="0"/>
    
    <!-- Step adjustment between market data updates (default: 2) -->
    <Property name="StepAdjBetweenMD" value="2"/>
    
    <!-- Step adjustment after market data (default: 1) -->
    <Property name="StepAdjAfterMD" value="1"/>
    
    <!-- Maximum tries between market data (default: 3) -->
    <Property name="MaxTriedBtwMD" value="3"/>
    
    <!-- Maximum error count (default: 10) -->
    <Property name="MaxError" value="10"/>
    
    <!-- Maximum total tries (default: 100) -->
    <Property name="MaxTried" value="100"/>
    
    <!-- Clear order wait time in milliseconds (default: 500) -->
    <Property name="ClearOrderWaitTime" value="500"/>
    
    <!-- Clear order price adjustment in ticks (default: 5) -->
    <Property name="ClearOrderPriceAdj" value="5"/>
    
    <!-- ========================================
         POSITION AND RISK PARAMETERS
         ======================================== -->
    <!-- Position adjustment step (default: 1) -->
    <Property name="AdjPosStep" value="1"/>
    
    <!-- Minimum available capital (default: 1000000) -->
    <Property name="MinAvailable" value="1000000"/>
    
    <!-- Minimum expiration day count (default: 30) -->
    <Property name="MinEDC" value="30"/>
    
    <!-- Last trading day offset (default: -1) -->
    <Property name="LtdD" value="-1"/>
    
    <!-- Margin rate (0.0 = use system margin) -->
    <Property name="MrgnRt" value="0.0"/>
    
    <!-- ========================================
         EXECUTION SETTINGS
         ======================================== -->
    <!-- Offset strategy (default: 3)
         - 0: Open/Close
         - 1: Open/CloseToday/CloseYesterday
         - 2: Buy/Sell
         - 3: Auto (recommended) -->
    <Property name="OffsetStrategy" value="3"/>
    
    <!-- Maximum number of worker threads (default: 10) -->
    <Property name="MaxWorker" value="10"/>
    
    <!-- TWAP second interval (default: 10) -->
    <Property name="TwapSecond" value="10"/>
    
    <!-- ========================================
         BACKTEST PARAMETERS
         ======================================== -->
    <!-- Is backtest mode (0=live, 1=backtest) -->
    <Property name="IsBacktest" value="0"/>
    
    <!-- Slippage in ticks for backtest (default: 0.5) -->
    <Property name="SlipTics" value="0.5"/>
    
    <!-- Cancel rate for backtest (0.0-1.0, default: 0.2) -->
    <Property name="CancelRate" value="0.2"/>
    
    <!-- ========================================
         ADVANCED SETTINGS
         ======================================== -->
    <!-- Enable fuzzy sort (0=disabled, 1=enabled) -->
    <Property name="FuzzySort" value="0"/>
    
    <!-- Enable trade flow logging (0=disabled, 1=enabled) -->
    <Property name="LogTrdFlw" value="1"/>
    
    <!-- ========================================
         TRADING SESSION TIMERS
         ======================================== -->
    <!-- Pre-trade session start (format: HH:MM:SS) -->
    <Property name="PreTrade" value="08:45:00"/>
    
    <!-- Day trade session start (format: HH:MM:SS) -->
    <Property name="DayTrade" value="09:00:00"/>
    
    <!-- Only close mode start (format: HH:MM:SS) -->
    <Property name="OnlyClose" value="14:50:00"/>
    
    <!-- Force close start (format: HH:MM:SS) -->
    <Property name="ForceClose" value="14:55:00"/>
    
    <!-- Day settlement time (format: HH:MM:SS) -->
    <Property name="DaySettle" value="15:00:00"/>
    
    <!-- Day end time (format: HH:MM:SS) -->
    <Property name="DayEnd" value="15:05:00"/>
    
    <!-- Night session end time (format: HH:MM:SS) -->
    <Property name="NtEnd" value="02:30:00"/>
    
    <!-- Period for periodic updates in seconds (default: 900 = 15 minutes) -->
    <Property name="PeriodSecond" value="900"/>
    
    <!-- ========================================
         SPREAD CONFIGURATIONS
         
         Define spreads to trade. Each spread can have:
         - name: Spread notation (e.g., "cu2501-cu2502")
         - exeName: Execution spread notation
         - TrdRt: Trade ratio constraint
         - RefMid: Reference mid price (DBL_MAX = auto)
         - SprdMaxLot: Maximum spread lots
         - SprdStpLot: Step size for this spread
         - ArbCfgDttm: Configuration date/time (format: YYYYMMDD-HH:MM:SS)
         ======================================== -->
    <ManSprds>
        <!-- Example Spread 1: Calendar spread -->
        <Spread name="cu2501-cu2502" 
                exeName="cu2501-cu2502"
                TrdRt="0"
                RefMid="100.0"
                SprdMaxLot="50"
                SprdStpLot="5"
                ArbCfgDttm="20251231-21:30:00"/>
        
        <!-- Example Spread 2: Another calendar spread -->
        <Spread name="cu2502-cu2503" 
                exeName="cu2502-cu2503"
                TrdRt="0"
                RefMid="80.0"
                SprdMaxLot="30"
                SprdStpLot="3"
                ArbCfgDttm="20251231-21:30:00"/>
                
        <!-- Add more spreads as needed -->
    </ManSprds>
    
</Strategy>

<!-- 
================================================================================
CONFIGURATION NOTES:

1. Grid Strategy Parameters:
   - Start with default values (GridSpacing=1.0, GridAsymmetry=0.5)
   - Increase GridSpacing if too many trades occur
   - Increase GridAsymmetry to close positions more aggressively
   - Set UsePositionGrid=0 for symmetric grid (not recommended)

2. Risk Management:
   - Set MinAvailable to ensure sufficient capital
   - Configure SprdMaxLot for each spread based on risk appetite
   - Use SprdStpLot to control trade size increments

3. Testing:
   - Start with IsBacktest=1 for backtesting
   - Use smaller SprdMaxLot values initially
   - Monitor trade flow logs (LogTrdFlw=1)

4. Session Times:
   - Adjust based on exchange trading hours
   - ForceClose should provide 5-10 minutes for position exit
   - DaySettle marks end of position taking

5. Order Management:
   - Increase wait times if experiencing too many cancellations
   - Adjust price ticks based on market liquidity
   - Use TryLegID=-1 for automatic leg selection

================================================================================
-->
